platform: Exabeam
source: windows_process_creation

conditions:
  event.category: 'process'

log_source:
  activity_type: process-create

default_log_source:
  activity_type: process-create

field_mapping:
  # Sigma field mappings to Exabeam CIM2 fields
  CommandLine: process_command_line
  Image: process_path
  ParentImage: parent_process_path
  ParentCommandLine: parent_process_command_line
  ProcessId: process_id
  ParentProcessId: parent_process_id
  ProcessGuid: process_guid
  ParentProcessGuid: parent_process_guid
  UtcTime: timestamp
  CreationUtcTime: timestamp
  User: user
  ParentUser: parent_process_user
  IntegrityLevel: process_integrity_level
  CurrentDirectory: process_working_directory
  LogonId: logon_id
  LogonGuid: logon_guid
  TerminalSessionId: terminal_session_id
  OriginalFileName: process_original_file_name
  Company: process_company
  Product: process_product
  Description: process_description
  FileVersion: process_file_version
  Hashes: process_hash
  md5: process_hash
  sha1: process_hash
  sha256: process_hash
  IMPHASH: process_imphash
  RuleName: rule_name
  
  # File and registry fields
  TargetFilename: file_path
  TargetObject: registry_path
  
  # System fields
  EventID: event_id
  Computer: src_host
  SubjectUserName: user
  TargetUserName: dest_user
  
  # Network fields
  SourceIp: src_ip
  DestinationIp: dest_ip
  DestinationPort: dest_port
  SourcePort: src_port